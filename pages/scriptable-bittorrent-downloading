Azureus is a pretty nice way to download torrents, but I tend to put it off in another workpsace and forget about it.  I thought it would be cool if I could reliably script a bittorrent download on the command line so that when it finished, some other scripted action(s) would happen (for example, send the file off somewhere else).

btdownloadheadless is perfect for this task.  All you need to do is kill it once you get to the "download succeeded" message.  I was going to write a Python script and even thought of putting in options to share X percentage of the file via upload before exiting (so you don't just download to 100% and then immediately exit without being a good citizen), but <code>grep -q</code> provided me a very quick and simple way to do what I wanted:

<pre>btdownloadheadless foo.torrent | tee out.txt | grep -iq "download succeeded"</pre>

<code>grep -q</code> will silently look through every line of output and do nothing, until it encounters the first occurrence of "download succeeded", at which point it will exit, causing the other two commands piped into it to exit as well.

You can then watch the output of btdownloadheadless by tailing out.txt with a fast polling rate:

<pre>tail -s 0.1 -f out.txt</pre>
